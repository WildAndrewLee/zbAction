!function(a,b){var c=function(){return this instanceof c?void(this._events={}):new c};c.prototype._ws=null,c.prototype._onload=null,c.prototype.on=function(a,b){if(!a)throw"No event specified.";if(!b)throw"No callback specified.";this._events[a]=this._events[a]||[],this._events[a].push(b)},c.prototype.off=function(a,c){if(a&&a in this._events!=!1){if(c===b)return void delete this._events[a];var d=this._events[a].indexOf(c);this._events[a].splice(d,1)}},c.prototype.emit=function(a){if(a&&a in this._events!=!1)for(var b=0;b<this._events[a].length;b++){var c=this._events[a][b],d=Array.prototype.slice.call(arguments,1);c.apply(this,d)}},c.prototype.load=function(a){this._ws=new WebSocket(a);var b=this;this._ws.onopen=function(){b._onload&&b._onload.apply(b,arguments)},this._ws.onmessage=function(a){var c=JSON.parse(a.data);b.emit(c.event,c)}},c.prototype.onload=function(a){this._onload=a},c.prototype.send=function(a){if(!this._ws)throw"You must connect to a websocket first.";this._ws.send(JSON.stringify(a))},a.Socket=c}(window),function(a,b,c){var d="ws://localhost:4242/sync",e={board_key:__zbAction.board_key,uid:$.zb.stat.mid,name:"andrew"},f=function(){if(!(this instanceof f))return new f;var a=b(),c=this;this._wait=[],a.onload(function(){a.send({key:0,type:"handshake",data:e})}),a.load(d);var g=function(b,c){i.hasOwnProperty(b)||a.on(b,c)},h=function(a,b){this.send=a.bind(null,b),this.register=g},i={handshake:function(b){var d=b.details,f=function(b,c){try{if(e.board_key!==c.receiver.board_key)throw new Error("Cross-board requests are not allowed.");c={event:c.event+"",details:JSON.stringify(c.details),source:e,receiver:{uid:parseInt(c.receiver.uid),board_key:c.receiver.board_key+""}}}catch(f){if("TypeError"===f.name)throw new Error("Invalid action data provided.");throw f}a.send({key:d,mod_key:b,type:"action",data:c})};c._wait.forEach(function(a){a.fn.call(null,new h(f,a.key))})}};for(var j in i)i.hasOwnProperty(j)&&a.on(j,i[j])};f.prototype.ready=function(a,b){if("string"!=typeof a)throw"You must specify an API key.";if("function"!=typeof b)throw"You must specify a function.";this._wait.push({key:a,fn:b})},a.zbAction=new f}(window,Socket);